<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BAGANIZA STORE (Nidal Abu Samra)</title>
  <style>
    body { font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif; margin:0; background:#f5f7fa; color:#333; }
    header { background: linear-gradient(90deg,#1e3c72,#2a5298); color:white; padding:15px 30px; display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; box-shadow:0 2px 8px rgba(0,0,0,0.2); }
    header h1 { margin:0; font-size:24px; font-weight:bold; }
    header h1 small { font-size:14px; color:#f1c40f; margin-left:6px; }
    #cart { position:relative; background:white; color:#333; padding:8px 18px; border-radius:20px; cursor:pointer; box-shadow:0 2px 5px rgba(0,0,0,0.3); font-weight:bold; }
    #cartItems { display:none; position:absolute; right:0; top:50px; background:white; border:1px solid #ccc; width:340px; padding:10px; border-radius:10px; box-shadow:0 3px 10px rgba(0,0,0,0.2); z-index:100; }
    #cartItems ul { list-style:none; margin:0; padding:0; }
    #cartItems li { margin:6px 0; font-size:14px; display:flex; justify-content:space-between; align-items:center; gap:6px; }
    .remove-btn { background:red; color:white; border:none; padding:3px 6px; border-radius:6px; cursor:pointer; font-size:12px; }
    #cartTotal { font-weight:bold; margin-top:10px; }
    #filters { background:#fff; padding:10px 20px; display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap; }
    #filters select,#filters input { padding:8px; border-radius:6px; border:1px solid #ccc; font-size:14px; }
    #productsContainer { display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:20px; padding:20px; }
    .product { background:white; padding:15px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.1); text-align:center; transition:transform 0.2s; }
    .product:hover { transform:translateY(-5px); }
    .product img { width:120px; height:120px; object-fit:cover; border-radius:10px; margin-bottom:10px; }
    .product h3 { margin:5px 0; font-size:18px; }
    .product p { font-size:14px; color:#666; }
    .product button { background:#2a5298; color:white; border:none; padding:8px 14px; border-radius:6px; cursor:pointer; margin-top:auto; }
    .product button:hover { background:#1e3c72; }
    #checkoutBtn { background:#27ae60; color:white; border:none; padding:8px 14px; border-radius:6px; margin-top:10px; cursor:pointer; }
    #checkoutBtn:hover { background:#1e8449; }
    .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); justify-content:center; align-items:center; z-index:200; }
    .modal-content { background:white; padding:20px; border-radius:12px; text-align:center; width:320px; box-shadow:0 2px 10px rgba(0,0,0,0.3); }
    .modal-content h2 { margin-top:0; font-size:20px; }
    .modal-content button { display:block; width:100%; margin:8px 0; padding:10px; border:none; border-radius:8px; cursor:pointer; font-size:15px; font-weight:bold; }
    .btn-cash { background:#27ae60; color:white; }
    .btn-stc { background:#8e44ad; color:white; }
    .btn-paypal { background:#3498db; color:white; }
    .btn-card { background:#e67e22; color:white; }
    footer { background:#1e3c72; color:white; text-align:center; padding:12px; font-size:14px; margin-top:20px; }
  </style>
</head>
<body>
  <header>
    <h1>BAGANIZA STORE <small>(Nidal Abu Samra)</small></h1>
    <div id="cart">ğŸ›’ (<span id="cartCount">0</span>)
      <div id="cartItems">
        <ul id="cartList"></ul>
        <p id="cartTotal">Total: 0 Ø±ÙŠØ§Ù„</p>
        <button id="checkoutBtn">Checkout</button>
      </div>
    </div>
  </header>

  <!-- Filters -->
  <section id="filters">
    <input type="text" id="searchBox" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬...">
    <select id="categoryFilter">
      <option value="All">ÙƒÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option>
      <option value="Electronics">Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª</option>
      <option value="Clothes">Ù…Ù„Ø§Ø¨Ø³</option>
      <option value="Food">Ø£Ø·Ø¹Ù…Ø©</option>
    </select>
  </section>

  <main id="productsContainer"></main>

  <!-- Payment Modal -->
  <div class="modal" id="paymentModal">
    <div class="modal-content" id="modalContent">
      <h2>Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</h2>
      <button class="btn-cash" onclick="selectMethod('Cash')">ğŸ’µ ÙƒØ§Ø´</button>
      <button class="btn-stc" onclick="selectMethod('STC Pay')">ğŸ“± STC Pay</button>
      <button class="btn-paypal" onclick="selectMethod('PayPal')">ğŸ’³ PayPal</button>
      <button class="btn-card" onclick="selectMethod('Card')">ğŸ’³ Ø¨Ø·Ø§Ù‚Ø© Ø¨Ù†ÙƒÙŠØ©</button>
      <br>
      <button onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
  </div>

  <footer>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© Ù†Ø¶Ø§Ù„ Ø£Ø¨Ùˆ Ø³Ù…Ø±Ø© 2025</footer>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCcWgFDzs95TbVU7v5h_5O0lNzZvBlL90o",
      authDomain: "baganiza-66bf0.firebaseapp.com",
      projectId: "baganiza-66bf0",
      storageBucket: "baganiza-66bf0.appspot.com",
      messagingSenderId: "1016966032123",
      appId: "1:1016966032123:web:fbffd397c7d8494fa79e5e"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const productsContainer = document.getElementById("productsContainer");
    const cart = {};
    const cartCount = document.getElementById("cartCount");
    const cartList = document.getElementById("cartList");
    const cartItemsDiv = document.getElementById("cartItems");
    const checkoutBtn = document.getElementById("checkoutBtn");
    const paymentModal = document.getElementById("paymentModal");
    const modalContent = document.getElementById("modalContent");
    const cartTotal = document.getElementById("cartTotal");

    let allProducts = [];

    function loadProducts() {
      db.collection("products").get().then(snapshot => {
        allProducts = [];
        snapshot.forEach(doc => {
          allProducts.push({ id: doc.id, ...doc.data() });
        });
        renderProducts(allProducts);
      });
    }

    function renderProducts(products) {
      productsContainer.innerHTML = "";
      products.forEach(product => {
        const productDiv = document.createElement("div");
        productDiv.className = "product";

        const img = document.createElement("img");
        img.src = product.imageUrl ? product.imageUrl : "https://via.placeholder.com/120";

        const name = document.createElement("h3");
        name.textContent = product.name;

        const desc = document.createElement("p");
        desc.textContent = product.description;

        const price = document.createElement("p");
        price.innerHTML = `<strong>${product.price} Ø±ÙŠØ§Ù„</strong>`;

        const btn = document.createElement("button");
        btn.textContent = "Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©";
        btn.onclick = () => addToCart(product.id, product);

        productDiv.appendChild(img);
        productDiv.appendChild(name);
        productDiv.appendChild(desc);
        productDiv.appendChild(price);
        productDiv.appendChild(btn);

        productsContainer.appendChild(productDiv);
      });
    }

    function addToCart(id, product) {
      if(cart[id]) cart[id].quantity++;
      else cart[id] = {...product, quantity: 1};
      updateCart();
    }

    function removeFromCart(id) {
      delete cart[id];
      updateCart();
    }

    function updateCart() {
      cartList.innerHTML = "";
      let count = 0, total = 0;
      for(let id in cart) {
        const li = document.createElement("li");
        const item = cart[id];
        const span = document.createElement("span");
        span.textContent = `${item.name} x ${item.quantity} = ${item.price * item.quantity} Ø±ÙŠØ§Ù„`;

        const removeBtn = document.createElement("button");
        removeBtn.textContent = "âŒ";
        removeBtn.className = "remove-btn";
        removeBtn.onclick = () => removeFromCart(id);

        li.appendChild(span);
        li.appendChild(removeBtn);
        cartList.appendChild(li);

        count += item.quantity;
        total += item.price * item.quantity;
      }
      cartCount.textContent = count;
      cartTotal.textContent = `Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total} Ø±ÙŠØ§Ù„`;
    }

    document.getElementById("cart").addEventListener("click", () => {
      cartItemsDiv.style.display = cartItemsDiv.style.display === "block" ? "none" : "block";
    });

    checkoutBtn.addEventListener("click", () => {
      paymentModal.style.display = "flex";
    });

    function closeModal() {
      paymentModal.style.display = "none";
      modalContent.innerHTML = `
        <h2>Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</h2>
        <button class="btn-cash" onclick="selectMethod('Cash')">ğŸ’µ ÙƒØ§Ø´</button>
        <button class="btn-stc" onclick="selectMethod('STC Pay')">ğŸ“± STC Pay</button>
        <button class="btn-paypal" onclick="selectMethod('PayPal')">ğŸ’³ PayPal</button>
        <button class="btn-card" onclick="selectMethod('Card')">ğŸ’³ Ø¨Ø·Ø§Ù‚Ø© Ø¨Ù†ÙƒÙŠØ©</button>
        <br><button onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>`;
    }

    function selectMethod(method) {
      if(method === "Cash") {
        modalContent.innerHTML = `<h2>Ø§Ù„Ø¯ÙØ¹ ÙƒØ§Ø´</h2><p>ğŸ’µ Ø³ØªÙ‚ÙˆÙ… Ø¨Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù….</p><button onclick="closeModal()">ØªÙ…</button>`;
      }
      if(method === "STC Pay") {
        modalContent.innerHTML = `<h2>STC Pay</h2><input type="text" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„"><button onclick="confirmPayment('STC Pay')">ØªØ£ÙƒÙŠØ¯</button>`;
      }
      if(method === "PayPal") {
        modalContent.innerHTML = `<h2>PayPal</h2><input type="email" placeholder="Ø£Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯ PayPal"><button onclick="confirmPayment('PayPal')">ØªØ£ÙƒÙŠØ¯</button>`;
      }
      if(method === "Card") {
        modalContent.innerHTML = `<h2>Ø¨Ø·Ø§Ù‚Ø© Ø¨Ù†ÙƒÙŠØ©</h2><input type="text" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©"><input type="text" placeholder="MM/YY"><input type="text" placeholder="CVV"><button onclick="confirmPayment('Card')">ØªØ£ÙƒÙŠØ¯</button>`;
      }
    }

    function confirmPayment(method) {
      alert("ØªÙ… Ø§Ù„Ø¯ÙØ¹ Ø¹Ø¨Ø± " + method);
      closeModal();
    }

    // ğŸ” Ø§Ù„Ø¨Ø­Ø« + Ø§Ù„ØªØµÙ†ÙŠÙ
    document.getElementById("searchBox").addEventListener("input", filterProducts);
    document.getElementById("categoryFilter").addEventListener("change", filterProducts);

    function filterProducts() {
      const searchValue = document.getElementById("searchBox").value.toLowerCase();
      const categoryValue = document.getElementById("categoryFilter").value;

      const filtered = allProducts.filter(p => {
        const matchesCategory = (categoryValue === "All") || (p.category && p.category === categoryValue);
        const matchesSearch = p.name.toLowerCase().includes(searchValue) || p.description.toLowerCase().includes(searchValue);
        return matchesCategory && matchesSearch;
      });

      renderProducts(filtered);
    }

    loadProducts();
  </script>
</body>
</html>
