<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>BAGANIZA STORE</title>
<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, #f8f4f0, #f0ece8);
    margin: 0;
    padding: 0;
    color: #333;
  }
  header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    background: #ff6f61;
    color: #fff;
    position: sticky;
    top: 0;
    z-index: 10;
  }
  header h1 {
    font-size: 22px;
    margin: 0;
    font-weight: bold;
  }
  header h1 span {
    font-size: 14px;
    font-weight: normal;
    color: gold;
  }
  #cartBtn {
    background: #fff;
    color: #ff6f61;
    border: none;
    padding: 8px 15px;
    border-radius: 20px;
    cursor: pointer;
    font-weight: bold;
  }
  .products {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
    padding: 20px;
  }
  @media(max-width: 768px){
    .products {
      grid-template-columns: repeat(3, 1fr);
    }
  }
  .product {
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    padding: 15px;
    text-align: center;
    display: flex;
    flex-direction: column;
  }
  .product img {
    max-width: 100%;
    border-radius: 8px;
    margin-bottom: 10px;
  }
  .product h3 {
    margin: 5px 0;
  }
  .product p {
    flex: 1;
    font-size: 14px;
    color: #555;
  }
  .product button {
    background: #ff6f61;
    color: #fff;
    border: none;
    padding: 8px;
    border-radius: 8px;
    cursor: pointer;
  }
  /* Modal styles */
  .modal {
    display: none;
    position: fixed;
    z-index: 20;
    left: 0; top: 0;
    width: 100%; height: 100%;
    background-color: rgba(0,0,0,0.5);
  }
  .modal-content {
    background: #fff;
    margin: 10% auto;
    padding: 20px;
    border-radius: 10px;
    width: 90%;
    max-width: 400px;
  }
  footer {
    text-align: center;
    padding: 15px;
    font-size: 12px;
    color: #777;
  }
</style>
</head>
<body>

<header>
  <h1>BAGANIZA STORE <span>(nIDAL aBU sAMRA)</span></h1>
  <button id="cartBtn">🛒 السلة (0)</button>
</header>

<main class="products" id="productsList"></main>

<!-- Cart Modal -->
<div id="cartModal" class="modal">
  <div class="modal-content">
    <h3>سلة المشتريات</h3>
    <ul id="cartItems"></ul>
    <button id="checkoutBtn">Checkout</button>
    <button onclick="closeCart()">إغلاق</button>
  </div>
</div>

<!-- Payment Modal -->
<div id="paymentModal" class="modal">
  <div class="modal-content">
    <h3>اختر طريقة الدفع</h3>
    <select id="paymentMethod">
      <option value="cash">دفع عند الاستلام</option>
      <option value="card">بطاقة ائتمان</option>
    </select>
    <input type="text" id="paymentInfo" placeholder="أدخل البيانات المطلوبة">
    <button id="confirmPayment">تأكيد الدفع</button>
    <button onclick="closePayment()">إغلاق</button>
  </div>
</div>

<footer>All Right Reserved for Nidal Abu Samra 2025</footer>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_AUTH_DOMAIN",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_BUCKET",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const productsList = document.getElementById('productsList');
  const cartBtn = document.getElementById('cartBtn');
  const cartModal = document.getElementById('cartModal');
  const cartItemsEl = document.getElementById('cartItems');
  const checkoutBtn = document.getElementById('checkoutBtn');
  const paymentModal = document.getElementById('paymentModal');
  const confirmPayment = document.getElementById('confirmPayment');
  let cart = {};

  function renderProducts() {
    db.collection('products').get().then(snapshot => {
      productsList.innerHTML = '';
      snapshot.forEach(doc => {
        const p = doc.data();
        const imgTag = p.imageUrl ? `<img src="${p.imageUrl}" alt="${p.name}">` : '';
        productsList.innerHTML += `
          <div class="product">
            ${imgTag}
            <h3>${p.name}</h3>
            <p>${p.description}</p>
            <strong>${p.price} $</strong>
            <button onclick="addToCart('${doc.id}', '${p.name}', ${p.price})">إضافة للسلة</button>
          </div>
        `;
      });
    });
  }

  function addToCart(id, name, price) {
    if(cart[id]) {
      cart[id].qty++;
    } else {
      cart[id] = { name, price, qty: 1 };
    }
    updateCartBtn();
  }

  function updateCartBtn() {
    let totalQty = Object.values(cart).reduce((sum, item) => sum + item.qty, 0);
    cartBtn.textContent = `🛒 السلة (${totalQty})`;
  }

  cartBtn.onclick = () => {
    cartItemsEl.innerHTML = '';
    for(let id in cart) {
      let item = cart[id];
      cartItemsEl.innerHTML += `<li>${item.name} × ${item.qty} — ${item.price * item.qty} $</li>`;
    }
    cartModal.style.display = 'block';
  };

  function closeCart() { cartModal.style.display = 'none'; }
  function closePayment() { paymentModal.style.display = 'none'; }

  checkoutBtn.onclick = () => {
    cartModal.style.display = 'none';
    paymentModal.style.display = 'block';
  };

  confirmPayment.onclick = () => {
    alert("تم الدفع وحفظ الطلب في Firebase");
    paymentModal.style.display = 'none';
    cart = {};
    updateCartBtn();
  };

  renderProducts();
</script>
</body>
</html>
