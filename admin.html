<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Admin - Add Product</title>
<style>
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
    max-width: 600px;
    margin: auto;
    background-color: #f0f2f5;
  }
  h1 {
    text-align: center;
    margin-bottom: 20px;
  }
  label {
    display: block;
    margin-top: 10px;
    font-weight: bold;
  }
  input, textarea, button {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
    box-sizing: border-box;
  }
  button {
    margin-top: 15px;
    background-color: #4CAF50;
    color: white;
    border: none;
    cursor: pointer;
  }
  button:hover {
    background-color: #45a049;
  }
</style>
</head>
<body>

<h1>Admin Panel - Add Product</h1>

<label>Product Name</label>
<input type="text" id="productName" placeholder="Enter product name" />

<label>Price</label>
<input type="number" id="productPrice" placeholder="Enter price" />

<label>Description</label>
<textarea id="productDescription" placeholder="Enter product description"></textarea>

<label>Image</label>
<input type="file" id="productImage" accept="image/*" />

<button id="addProductBtn">Add Product</button>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>

<script>
  // Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyCcWgFDzs95TbVU7v5h_5O0lNzZvBlL90o",
    authDomain: "baganiza-66bf0.firebaseapp.com",
    projectId: "baganiza-66bf0",
    storageBucket: "baganiza-66bf0.appspot.com",
    messagingSenderId: "1016966032123",
    appId: "1:1016966032123:web:fbffd397c7d8494fa79e5e"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  const storage = firebase.storage();

  document.getElementById("addProductBtn").addEventListener("click", async () => {
    const name = document.getElementById("productName").value.trim();
    const price = parseFloat(document.getElementById("productPrice").value.trim());
    const description = document.getElementById("productDescription").value.trim();
    const imageFile = document.getElementById("productImage").files[0];

    if (!name || !price || !description || !imageFile) {
      alert("Please fill all fields and choose an image.");
      return;
    }

    try {
      // رفع الصورة إلى Storage
      const storageRef = storage.ref("product_images/" + Date.now() + "_" + imageFile.name);
      await storageRef.put(imageFile);
      const imageUrl = await storageRef.getDownloadURL();

      // حفظ البيانات في Firestore
      await db.collection("products").add({
        name: name,
        price: price,
        description: description,
        imageUrl: imageUrl,
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      });

      alert("✅ Product added successfully!");
      
      // مسح الحقول
      document.getElementById("productName").value = "";
      document.getElementById("productPrice").value = "";
      document.getElementById("productDescription").value = "";
      document.getElementById("productImage").value = "";

    } catch (error) {
      console.error("Error adding product:", error);
      alert("❌ Failed to add product. Please try again.");
    }
  });
</script>

</body>
</html>
